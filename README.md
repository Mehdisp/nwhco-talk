# 📝 تسک: تکمیل فیچر «Talk» در پروژه Habib

## 📌 شرح کلی
پروژه‌ای به نام **Habib** در اختیار شما قرار دارد. بخشی از این پروژه مربوط به فیچری به نام **Talk** است که هنوز کامل نشده. وظیفه شما این است که این فیچر را تکمیل کنید.  

---

## 🔹 جزئیات فیچر Talk

۱. صفحات اصلی  
فیچر Talk شامل دو صفحه اصلی است:  

۱.۱ **صفحه اول: لیست مشاورها**  
- دیتای این صفحه باید از طریق **وب‌سوکت (Socket)** دریافت شود.  
- اتصال سوکت باید از زمان شروع برنامه برقرار شده و **قطع نشود**.  
- با کلیک روی هر مشاور، کاربر وارد **صفحه چت** با آن مشاور شود.  

۱.۲ **صفحه دوم: راهنماها (Guidelines)**  
- دیتای این صفحه باید از طریق **API** دریافت شود.  
- داده‌ها باید با استفاده از **Hive** کش (Cache) شوند تا در حالت آفلاین هم نمایش داده شوند.  

۲. صفحه چت (Chat Screen)  
- در این صفحه باید امکان:  
  - **ارسال پیام متنی** فراهم شود.  
  - **دریافت پیام‌های جدید** از مشاور (از طریق سوکت) نمایش داده شود.  
- پیام‌ها باید به ترتیب زمانی نمایش داده شوند.  
- در هنگام ارسال پیام، وضعیت پیام (در حال ارسال / ارسال شد / خطا) مشخص باشد.  
 

---

## ⚙️ نکات مهم
- معماری: **Clean Architecture** (Presentation, Domain, Data).  
- مدیریت State باید حتماً با **Bloc** انجام شود.  
- دیتای Guidelines باید با **Hive** ذخیره و مدیریت شود.  
- اتصال WebSocket باید مدیریت Lifecycle داشته باشد (قطع نشود حتی در جابه‌جایی صفحات).  
- UI بر اساس طراحی نهایی آماده‌شده در **Figma** پیاده‌سازی شود.  

---

## 📡 مشخصات API و Socket

### 🔸 آدرس وب‌سوکت

wss://qa.habibapp.com/ws/?version=3&t={token}&language={language}&platform={android/ios}

**توجه: {token} {language} و platform با مقادیر صحیح جایگذاری شوند**

دریافت لیست مشاورین:
```json
{
  "action": "getConsultants",
  "language_code": "en",
}
```
شروع اتاق جدید چت:
```json
{
  "action": "startRoom",
  "consultant": username,
  "room_type": "chat",
}
```

دریافت تاریخچه ی پیام ها:
```json
{
  "action": "getHistory",
  "room": id,
}
```

ارسال پیام به اتاق:
```json
{
  "action": "sendMessage",
  "room": id,
  "text": text,
  "payload": "",
}
```

حذف پیام:
```json
{
  "action": "deleteMessage",
  "message_id": messageId,
}
```



---



### 🔸 آدرس API های موردنیاز
- **لیست راهنماها (Guidelines):**

```GET https://habibapp.com/api/talk/guidelines/```

Response:
```json
[
  {
    "type": "user/provider",
    "title": "",
    "description": ""
  }
]
```

---


## ✅ خروجی مورد انتظار
- لیست مشاورها از طریق Socket نمایش داده شود.  
- راهنماها (Guidelines) از API گرفته و در Hive کش شوند.  
- صفحه چت با امکان ارسال و دریافت پیام متنی پیاده‌سازی شده باشد.  
- وضعیت پیام‌ها (Pending, Sent, Failed) مدیریت شود.



---

## 📊 معیارهای ارزیابی (Evaluation Criteria)
- **معماری:** رعایت Clean Architecture و جداسازی لایه‌ها (Presentation, Domain, Data).  
- **State Management:** استفاده صحیح از Bloc و ساختاردهی درست Cubit/Blocها.  
- **Networking & Realtime:** مدیریت درست اتصال WebSocket و API Callها.  
- **Caching:** ذخیره و مدیریت داده‌ها با Hive و نمایش صحیح در حالت آفلاین.  
- **کد تمیز (Clean Code):** رعایت اصول SOLID، نام‌گذاری مناسب و خوانایی کد.  
- **پایداری:** مدیریت خطاها (قطع اینترنت، خطای سرور، خطای سوکت).  
- **UI/UX:** پیاده‌سازی دقیق بر اساس طراحی Figma و ارائه تجربه کاربری روان.  
